# サンプリング手法 - 四択問題1

## 問題
**Top-p サンプリング（Nucleus Sampling）**の基本的な動作原理として最も適切なものはどれですか。

## 選択肢
A. 確率が最も高い上位k個のトークンから選択する手法

B. 累積確率がp以上になる最小のトークン集合から選択する手法

C. 温度パラメータのみで確率分布を調整する手法

D. すべてのトークンから等確率で選択する手法

## 正解
**B**

## 解説
**Top-p サンプリング（Nucleus Sampling）**は、確率の高いトークンから順に累積確率を計算し、その**累積確率がp以上になる最小のトークン集合**（nucleus）を動的に決定してサンプリングを行う手法です。

**動作メカニズム**
1. **確率分布の取得**：モデルが出力する各トークンの確率分布を取得
2. **降順ソート**：確率の高い順にトークンを並び替え
3. **累積確率計算**：上位から順に確率を累積
4. **Nucleus決定**：累積確率がp（例：0.9）に達する最小のトークン集合を特定
5. **再正規化**：選択されたトークン集合内で確率を再正規化
6. **サンプリング**：再正規化された確率分布からトークンを選択

**従来手法との違い**
- **Top-k サンプリング**：固定のk個から選択（選択肢A）
- **Temperature サンプリング**：温度パラメータで分布調整（選択肢C）
- **Uniform サンプリング**：等確率選択（選択肢D）

**Top-p サンプリングの特徴**
- **動的な候補数調整**：文脈に応じて適切な多様性を確保
- **文脈適応性**：モデルの確信度に応じて選択肢を調整
- **品質と多様性のバランス**：高品質を保ちながら創造性を維持

Top-p サンプリングは現代の大規模言語モデルにおいて最も広く使用されているサンプリング手法の一つです。 